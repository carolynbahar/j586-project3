<!DOCTYPE html>

<html>
<head>
    <meta Content-Type: text/html; charset=utf-8>
    <title>Project 3</title>
    
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>

    <script type="text/javascript">
        
        var farmerMarket =[];
    
    $(document).ready(function() //runs the functions
      {

        $.ajax({ //loads in xml file
		type: "GET",
		url: "myData.xml",
		dataType: "xml",
		success: parseXML
	});
	
	function parseXML(xml) { 
                    

        $(xml).find('city').each(function(){ //starts loop to find all ROWs, etc
            //console.log("once for every row");
            var $city = $(this);
            console.log(this);
            //var name = $person.attr("name");
            //var description = $person.find('description').text();
            //var imageurl = $person.attr('imageurl');
	    farmerMarket.push(parseInt($city.find('markets').text())); //parseInt is a function that says turn this text into an integer. Push adds the data to the back of each one so that order makes sense. Pop goes to the front.

            //var html = '<dt> <img class="bioImage" alt="" src="' + imageurl + '" /> </dt>';
            //html += '<dd> <span class="loadingPic" alt="Loading" />';
            //html += '<p class="name">' + name + '</p>';
            //html += '<p> ' + description + '</p>' ;
            //html += '</dd>';

            //$('dl').append($(html));
            
	    
        });
	
	console.log(farmerMarket);
	buildChart(); //finally builds chart -- needs to be inside function but outside loop so it won't try to write the chart 100 times, etc.
    }
    
    
    
    
function buildChart() {
    $('#scatter-graph').highcharts({
        chart: {
            type: 'scatter',
            zoomType: 'xy'
        },
        title: {
            text: 'Amount of Funding for Health/Food Versus Number of Farmers Markets by Too and Least States'
        },
        subtitle: {
            text: 'Source: Heinz  2003'
        },
        xAxis: {
            title: {
                enabled: true,
                text: 'Amount of Funding ($)'
            },
            startOnTick: true,
            endOnTick: true,
            showLastLabel: true
        },
        yAxis: {
            title: {
                text: 'Number of Farmers Markets'
            }
        },
        legend: {
            layout: 'vertical',
            align: 'left',
            verticalAlign: 'top',
            x: 60,
            y: 50,
            floating: true,
            backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF',
            borderWidth: 1
        },
        plotOptions: {
            scatter: {
                marker: {
                    radius: 5,
                    states: {
                        hover: {
                            enabled: true,
                            lineColor: 'rgb(100,100,100)'
                        }
                    }
                },
                states: {
                    hover: {
                        marker: {
                            enabled: false
                        }
                    }
                },
                tooltip: {
                    headerFormat: '<b>{series.name}</b><br>',
                    pointFormat: '{point.x} markets, ${point.y} of funding'
                }
            }
        },
        series: [{
            name: 'Fullerton, ND',
            color: 'rgba(223, 83, 83, .5)',
            data: [[0, 392]]

        }, {
            name: 'Madison, WI',
            color: 'rgba(119, 152, 191, .5)',
            data: [[18, 4126641]]
        }, {
            name: 'Dallas, OR',
            color: 'rgba(119, 152, 191, .5)',
            data: [[1, 10199264]]
        }]
	});
    };
});
        
        
        
</script>


</head>

<body>

<div id="scatter-graph" style="width:90%; height:500px;"></div>
<div id="bar-chart" style="width:100%; height:400px;"></div>
<div id="pie-chart" style="width:50%; height:400px;"></div>


</body>
</html>


</body>
</html>
